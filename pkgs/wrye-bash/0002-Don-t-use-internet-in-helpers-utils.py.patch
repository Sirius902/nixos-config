From a8915a6f5ed8fbab9543cd932a02a140f4c5f090 Mon Sep 17 00:00:00 2001
From: Sirius902 <10891979+Sirius902@users.noreply.github.com>
Date: Wed, 24 Dec 2025 18:40:07 -0800
Subject: [PATCH 2/3] Don't use internet in helpers/utils.py

Importing pygit2 tries to access the internet, which is not allowed in
a nix build environment.
---
 scripts/helpers/utils.py | 17 -----------------
 1 file changed, 17 deletions(-)

diff --git a/scripts/helpers/utils.py b/scripts/helpers/utils.py
index 2aabfb5f8..e1e5658e9 100644
--- a/scripts/helpers/utils.py
+++ b/scripts/helpers/utils.py
@@ -35,8 +35,6 @@
 from pathlib import Path
 from urllib.request import urlopen
 
-import pygit2
-
 # Reusable path definitions
 SCRIPTS_PATH = Path(__file__).absolute().parent.parent
 ROOT_PATH = SCRIPTS_PATH.parent
@@ -218,21 +216,6 @@ def get_repo_sig(repo):
             file=sys.stderr)
         sys.exit(1)
 
-def commit_changes(*, changed_paths: list[os.PathLike | str], commit_msg: str,
-        repo_path: os.PathLike | str = ROOT_PATH):
-    """Commit changes to the specified files by creating a commit with the
-    specified message."""
-    repo = pygit2.Repository(repo_path)
-    user = get_repo_sig(repo)
-    parent = [repo.head.target]
-    for cf in changed_paths:
-        rel_path = os.path.relpath(cf, repo.workdir).replace('\\', '/')
-        if repo.status_file(rel_path) == pygit2.GIT_STATUS_WT_MODIFIED:
-            repo.index.add(rel_path)
-    tree = repo.index.write_tree()
-    repo.create_commit('HEAD', user, user, commit_msg, tree, parent)
-    repo.index.write()
-
 def out_path(dir_=OUT_PATH, name='out.txt'):
     """Returns a path joining the dir_ and name parameters. Will create the
     dirs in dir_ if not existing.
-- 
2.51.2

